package com.ftsafe.iccbd.utils.security.rsa;

import junit.framework.TestCase;
import org.bouncycastle.asn1.ASN1InputStream;
import org.bouncycastle.asn1.ASN1Primitive;
import org.bouncycastle.asn1.util.ASN1Dump;
import org.jpos.iso.ISOUtil;

import java.io.ByteArrayInputStream;
import java.security.PrivateKey;
import java.security.PublicKey;

/**
 * Created by ft on 2016/12/22.
 */
public class RSAHelperTest extends TestCase {
    public void testGeneratePrivateKey() throws Exception {

        String str = "30818702818100E1C2E9A6DFE1ACAD6529FFE2AA10EDAAE391FD75A1410FE1C6332603D6D2EE6EB1F3467020801D3F6BCE3C9A6E4D55082735227AB5956361DA319C0C8426AAA60B40D7409749A0BA95A996D75B91010A27AC4737AFB93F1E72A5CF0CF076080C95C1CD94FBAC80CDF3C954321D278882DF8B4A2985935D36A927CEF1B22B61B50201033036323800020270184CA0FE7AF650BF92CD056696BBB83D584079987FB5F75917AF5DBB6C5D278317AF5DBB6C5D2783BD25FB6BDF3E65990764C37CAF8CEC2E84D4C4B3CE0B93A822010353FE7D50EEF9FE7F0D0124D1ADBCA910DB58DA5B078521CDF09877CF44C75E70523DEECC80E412DC59B7BE4B015613ED25DC5331FDB27AAC2F6CE0C1E7373A253CCDE86BF981009C58654AE8BD94EA9671E67C9B53ED41AFFEAAFC532A262034A69D982E18048ABD04BE1FE085130B4B66B8FF21961FDA6972969DB4522E274FB02699A17E4E3988447CFB642328AE2C97CA7DCF817E01ACF5625A7172A899AF11828A5EE2566BFD77A79721E5F1ACC93FAAC9D0E7CF1059A1C26BD4202701E40E908B97CA7A23AFC9A1094A61DCE33AA0B4F53932E0F26E25A3C6E15EBFAAAE91BAC63F762B346F75A3229F0A633BD36AB20226199819DB1D329B1D62121C011F28BCADC3377602FDFD65B45B8BDB847050C3BADFA6B3BDADDEDAC93FB7C4E12538C4DD7B03D3342CE5473008E5A60C19BD112C5852C7EBC4C42ED12E206DECF798BC505718F7BB560F49C35000C03D7936EB0D8EA0F0B06553760827B8371C96EA63918C015DA0917746BCB445854DF22C7293DDB0BA8D7744E896CDE9B032530E776419BB95F4AB5B99190D312CFC902E02DE7E42887773E095DCBB82F18CE01D9FE8D0051E1DDD25EBDA5B937D3EC94A3599B68822C5CEEECD8B18373794DD869C7A233E1D8AA7D4B98D2E176D42E610C46D4F4E3791DDC04F7521348AA520D37F3031EE20C7195D9057275369240E3601F64F13CE6CD6BA71BF1F11A6866A03EE564461374B42E977D0E8D00E868331DE412ED777D1C5574EE8EBAF0FD0B6536D20AD5A1D449453864AE9";
        ASN1InputStream bIn = new ASN1InputStream(new ByteArrayInputStream(ISOUtil.hex2byte(str)));
        ASN1Primitive obj = bIn.readObject();
        System.out.println(ASN1Dump.dumpAsString(obj));
        byte[] pk = obj.getEncoded();
        String pk_str = ISOUtil.hexString(pk);
        System.out.println("公钥："+pk_str);
        int pkIndex = pk_str.length();
        String sk_str = str.substring(pkIndex);
        System.out.println("私钥："+sk_str);
        String sk_str_dec = "6902000000000000000000000004000008000000000400000002000000020000000200000002000000020000E1C2E9A6DFE1ACAD6529FFE2AA10EDAAE391FD75A1410FE1C6332603D6D2EE6EB1F3467020801D3F6BCE3C9A6E4D55082735227AB5956361DA319C0C8426AAA60B40D7409749A0BA95A996D75B91010A27AC4737AFB93F1E72A5CF0CF076080C95C1CD94FBAC80CDF3C954321D278882DF8B4A2985935D36A927CEF1B22B61B5039681F119EA96731E43715541C6B5F3C7426153A3C0D60A9684221957E48C9EF476A22EF56B00137F9D342866F4338E056F78C1A723B8ECEBE6CBBD5DAD6F1C6D719EB29CAAA68F301308AA39CA0C8AD2E1C12509AF5CB077B76582A55EE132DC69D124046D335554A52159065A6EB6BB8DAE25A48CDCD3C3E2FEC57D4385D6ABF21B930E03365B5023E221B17B18E69350697D83812EF41D0C92F64EA39F0F95BAA2A3BDD8FE0DFBE02FAC5B4793EE97FC6C1B7D9A0F9BA6A191F5443004ED35EEB7384794196EA2553A75CF31654A3A84A11225A77F424DD2FA94C63E852C2C3C6573D07EE172D31BE7A24D4DED87D18E99F635183883EA3317B1719CDDB281D23C801DD16ABA0BE97380106E1C132DE8005E4508794182D108BD943387FC9CAB671E71A97DF08CDD1420F2AFDA29331306E26BC0E54D634DE275222D3DC819A167B75EACCEE78AC296C120FCBB4462359BA902561F4D68B30CA4346D14B50E7C6C6D293B54095295751D922FB7F46552F2BCFE66B5126F16614E2D75589E239F24D02FB810F46C38D1A3DF764386D1ADC0B6C3C4FF81893751B88429AE1D72D2EE4D35A9EBA1E2129A6C33894905365F114ECE1025AD46CCBA764BBDE921AB000000";

//        // 解析私钥
//        PrivateKey privateKey = RSAHelper.generatePrivateKey(ISOUtil.hex2byte(sk_str_dec));
//        System.out.println(privateKey.getAlgorithm());
//        // 解析公钥
//        PublicKey publicKey = RSAHelper.geneneratePublicKey(pk);
//        System.out.println(publicKey.getAlgorithm());
    }
}